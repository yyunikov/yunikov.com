<!doctype html>
<html lang="en">

	<head>
		<title>Yuriy Yunikov | Java and Android Software Engineer</title>

<meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta name="keywords" content="yunikov, software, java, android, developer, development, engineer">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="Java software engineer and Android enthusiast with 2+ years of experience interested in software design and development.">
<meta name="author" content="Yuriy Yunikov">
<meta name="language" content="english" />

<link rel="stylesheet" href="/css/main.css" shim-shadowdom />

<link rel="import" href="/components/polymer/polymer.html">
<link rel="import" href="/components/font-roboto/roboto.html" />
<link rel="import" href="/components/core-icons/hardware-icons.html">

<link rel="import" href="/elements/app-layout.html" />
<link rel="import" href="/elements/app-card.html" />
<link rel="import" href="/elements/github-card.html" />
  		<link rel="shortcut icon" type="image/png" href="/images/favicon.png"/>
  		<link rel="apple-touch-icon" type="image/png" href="/images/yunikov.57.png"><!-- iPhone -->
		<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="/images/yunikov.72.png"><!-- iPad -->
		<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="/images/yunikov.114.png"><!-- iPhone4 -->
		<link rel="icon" type="image/png" href="/images/yunikov.144.png">
	</head>

	<body id="main" class="default" unresolved>
	
		<app-layout
	mainTitle="Yuriy Yunikov"
	subTitle="Java/Android Software Engineer"
	menuItem="3"
	unresolved>
	
	<article class="post">
	
		<app-card class="entry">
			<h1>Working with local SQLite database</h1>
			
			<p>While creating Android apps, we often use SQLite database to store some data. Sometimes we just need to reuse the existing database stored locally on the device. One of the ways is just to store your local SQLite database in <code>/res/assets</code> folder. Let's consider this example and look at one of the approaches for using it in code.</p>

<p><strong>Creating database helper classes</strong></p>

<p>First thing that we need to do is to create a class, which extends <code>SQLiteOpenHelper</code> and looks for our database in the <code>/res/assets</code> folder of your Android app.</p>

<script src="https://gist.github.com/yyunikov/0e8448d0b7eeaee71782.js?file=SQLiteAssetsHelper.java"></script>


<p>We can create a simple <a href="http://en.wikipedia.org/wiki/Singleton_pattern">Singleton</a> which extends <code>SQLiteAssetsHelper</code> and overrides it's <code>onCreate()</code> and <code>onUpgrade()</code> methods. Let's leave them empty for now, but you can do upgrading of your database here or any other work needed on creation of your database later.</p>

<script src="https://gist.github.com/yyunikov/0e8448d0b7eeaee71782.js?file=DbHelper.java"></script>


<p>Taking into account the fact that we need to open and get the database instance to work with it all the time, we can create a simple manager for that. This class will also help to prevent the concurrent access to our database, because we use <code>synchronized</code> word here.</p>

<script src="https://gist.github.com/yyunikov/0e8448d0b7eeaee71782.js?file=DbManager.java"></script>


<p><strong>Database entities and queries</strong></p>

<p>If in our local database we have multiple entities, it would be good to make some superclass for them.</p>

<script src="https://gist.github.com/yyunikov/0e8448d0b7eeaee71782.js?file=Entity.java"></script>


<p>One of the popular ways of quering objects is the <a href="http://en.wikipedia.org/wiki/Data_access_object">DAO</a> pattern.
To make easier creating of <code>DAO</code> classes we can create a master class for them which will contain some of the common popular methods, mostly the <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> operations.</p>

<script src="https://gist.github.com/yyunikov/0e8448d0b7eeaee71782.js?file=DaoMaster.java"></script>


<p>If we will need to create <code>DAO</code> class for some entity later, we will just extend the <code>DaoMaster</code> class.</p>

<p><strong> Common Adapter</strong></p>

<p>To make our life easier in future when working with <code>ListView</code>, <code>Spinner</code> or any other Android views which need <code>Adapter</code> classes, we can create a parent <code>Adapter</code> class for our entities.</p>

<script src="https://gist.github.com/yyunikov/0e8448d0b7eeaee71782.js?file=EntityAdapter.java"></script>


<p><strong>Usage and Example</strong></p>

<p>The adapter above will very useful in future, when you will create a new <code>Entity</code>. Let's consider the example if we have the new <code>Entity</code> from the database called <code>NamedEntity</code>.</p>

<script src="https://gist.github.com/yyunikov/0e8448d0b7eeaee71782.js?file=NamedEntity.java"></script>


<p>Creating an adapter for such entity will be easy and look in the following way.</p>

<script src="https://gist.github.com/yyunikov/0e8448d0b7eeaee71782.js?file=NamedEntityAdapter.java"></script>


<p>After writing such a lot of code, let's take a loook on the example usage of everthing together that we've created. I will assume that we have an entity called <code>Some</code> (which extends <code>Entity</code> class) and the <code>DAO</code> for it, called <code>SomeDao</code> (which extends <code>DaoMaster</code> class).</p>

<script src="https://gist.github.com/yyunikov/0e8448d0b7eeaee71782.js?file=Usage.java"></script>


<p><strong>Conclusion</strong></p>

<p>Described approach of working with local database may look very complicated, however it helps a lot if you have multiple entities and queries to your local database and showed itself for me as a good long term solution.</p>


			<div class="post-date">
			Posted on February  4, 2015
			</div>
		</app-card>

		
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
    
	    var disqus_shortname = 'yunikovcom';
	    var disqus_developer = 1;
	    var disqus_identifier = "/blog/android/2015/02/04/Working-With-Local-SQLite-Database/";

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

	</article>

</app-layout>

		<a href="https://plus.google.com/+YuriyYunikov/" rel="publisher"></a>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-41878921-5', 'auto'); // ebidel's
  ga('send', 'pageview');
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript" src="/components/webcomponentsjs/webcomponents.min.js"></script>
<script type="text/javascript" src="/js/app.js"></script>

	</body>

</html>
