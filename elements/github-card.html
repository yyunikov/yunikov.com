<polymer-element name="github-card" attributes="user">

  <template>

  <style>
    :host {
      display: inline-block;
    }
    .user {
      font-family: "Helvetica", Arial, sans-serif;
      display: inline-block;
      width: 208px;
      height: 250px;
      overflow: hidden;
      border-radius: 6px;
      position: relative;
      background-color: #2E353C;
      text-align: center;
      color: #fff;
      font-weight: 100;
      transition: background 1000ms ease-out;
    }
    .user dl,
    .user dd {
      margin: 0;
    }
    .user dt {
      display: none;
    }
    .user-data {
      background: #fff url('../images/github-small.png') no-repeat 5px 5px;
      background-size: 25px;
      height: 60px;
      border: 1px solid #D5D5D5;
      border-bottom:0;
    }
    dd.user-avatar {
      display: inline-block;
      margin: 20px 0 10px;
    }
    .user-avatar img {
      border-radius: 100%;
      height: 80px;
      width: 80px;
      border: 3px solid #fff;
      vertical-align: middle;
      background-color: #fff;
    }
    dd.user-name,
    dd.user-account {
      margin: 5px 0;
    }
    .user-name {
      font-size: 24px;
    }
    .user-account {
      font-size: 16px;
      color: #999;
      margin: 5px 0;
    }
    .user-stats {
      border-top: 1px groove #999;
      position: relative;
      top: 130px;
    }
    .user-stats dd {
      padding: 10px 20px;
    }
    .user-repos,
    .user-following,
    .user-followers {
      display: inline-block;
      font-size: 22px;
      color: #999;
    }
    .user-repos:after,
    .user-following:after,
    .user-followers:after {
      content: attr(data-stats);
      text-transform: uppercase;
      display: block;
      font-size: 11px;
      color: #666;
      font-weight: normal;
      line-height: 1.7em;
    }
    .spinner {
      background: url('../images/spinner.gif') no-repeat center center;
    }
    a,
    a:link,
    a:visited {
        text-decoration: none;
        color: white;
    }
  </style>

    <content>
      <article id="element" class="user spinner">
        <dl class="github">
          <dt>github</dt>
          <dd><a href="https://github.com/" target="_blank"></a></dd>
        </dl>
        <dl class="user-data">

          <dt>Avatar:</dt>
          <dd class="user-avatar">
            <a href="https://github.com/{{github.login}}" target="_blank"><img src="{{github.avatar_url}}" /></a>
          </dd>

          <dt>Fullname:</dt>
          <dd class="user-name">{{github.name}}</dd>

          <dt>Account:</dt>
          <dd class="user-account"><a href="https://github.com/{{github.login}}" target="_blank">{{github.login}}</a></dd>
        </dl>
        <dl class="user-stats">
          <dt>Repos</dt>
          <dd class="user-repos" data-stats="repos">
            <a href="https://github.com/{{github.login}}?tab=repositories" target="_blank">{{github.public_repos}}</a>
          </dd>

          <dt>Followers</dt>
          <dd class="user-followers" data-stats="followers">
            <a href="https://github.com/{{github.login}}/followers" target="_blank">{{github.followers}}</a>
          </dd>
        </dl>
      <article>
    </content>

  </template>

  <script>
    (function() {
    Polymer('github-card', {
      /**
       * github userid
       *
       * @attribute user
       * @type string
       */
      user: '',
      ready: function() {
        this.github = {};
        this.xhr = document.createElement('polymer-xhr');
        this.load = load.bind( this );
     },
      userChanged: function() {
        this.reload();
      },
      callbackXHR: function( err, data ) {
        this.github = data;
        this.$.element.className = this.$.element.className.replace(/spinner/, ''); 
      },
      /**
       * Realoads user data from github.
       *
       * @method reload
       * @return {Object} Returns undefined.
       */
      reload: function() {
        this.load( this.xhr, this.user, this.callbackXHR.bind( this ));
      }
    });
    var githubUrl = 'https://api.github.com/users/';
    function load( xhr, user, cb ) {
      xhr.request({
        method: 'GET',
        url:    githubUrl + user,
        callback: function( raw ) {
          try {
            var obj = JSON.parse( raw );
            cb( null, obj );
          } catch( err ) {
            console.log( 'error while parsing json', arguments );
            cb( arguments, null );
          }
        }
      });
    }
    })();
  </script>

</polymer-element>